var ie6 = ! -[1, ] && !window.XMLHttpRequest;
function action() {
    $(document.body).append('<div id="roll" style="display:none;"><div title="回到顶部" id="roll_top"></div></div>');
    $("#roll_top").click(function () {
        $("html,body").animate({
            scrollTop: "0px"
        }, 800)
    });
    $("#ct").click(function () {
        $("html,body").animate({
            scrollTop: $(".ct").offset().top
        }, 800)
    });
    $(document.body).append($("div.t_bg").clone().addClass("h_head_gd").hide());
    var div = $("div.h_head_gd");
    $(window).scroll(function (a) {

        if ($(this).scrollTop() > 260) {
            $("#roll").fadeIn()
        } else {
            $("#roll").fadeOut()
        }

        if ($(this).scrollTop() > 140) {
            div.show()
        } else {
            div.hide()
        }
    }).scroll();
};

function SelectMenu() {
    var $menu = $("div.h_nav").eq(0);
    var length = 0;
    var _cur = "cur";
    var $info = $("div.plc,div.plc2,div.pro_curmbs").find("a");
    var getCurrUrl = function (href) {
        href = href || '';
        var length = href.length;
        var index = href.lastIndexOf('/');
        if (index + 1 == length) {
            if ('new/help/job/feedback/friendlink/neatupload/product/project/search/user/default.htm'.concat(href)) {
                index = href.indexOf('/');
                length = length - 1
            } else {
                index = href.indexOf('/', index - 9)
            }
        }
        href = href.substr(index, length);
        if (!href.match(/\.[shtml|html|aspx]{4,5}/) && href.lastIndexOf('/') != href.length - 1) {
            href = href + "/"
        }
        return href;
    }
    var href = '';
    length = length == 0 ? $info.size() : length;
    var as = $menu.find('a');
    while (length > 0) {
        href = $info.eq(length - 1).attr('href');
        var url = getCurrUrl(href).toLowerCase();
        for (var i = 0; i < as.length; i++) {
            var href = as.eq(i).attr('href').toLowerCase() + '/';
            if (href.indexOf(url) > -1) {
                as.eq(i).parent('li').addClass(_cur);
                length = -1;
                return;
            }
        }
        length = length - 1
    }
    if (length != -1) {
        $menu.find('li:eq(0)').addClass(_cur);
    }
};
$(function () {
    var value = $('#seachkeywords').val();
    $('#seachkeywords').focus(function () {
        if (this.value == value) {
            this.value = '';
        }
    }).blur(function () {
        if (this.value == '') {
            this.value = value;
        }
    }).keypress(function (event) {
        if (event.keyCode == '13') {
            $('#sousuo').click();
            return false;
        }
    });
    $('#sousuo').click(function () {
        var xz = $('#seachkeywords').val();
        if (xz == value) {
            xz = "";
        }
        window.location.href = 'Search/Index.aspx@objtype=product&kwd=' + xz;
    });
    SelectMenu();
    action();
})